# Hetergeneous Evaluation using K-Means Clustering

This repository contains all the code used to run k-means in several configurations.

[Please see the important note below.](#important-note)

## Configurations

Below are explanations of the configurations for each directory

### Serial

The [serial](./serial) confiuration allows to run k-means without any concurrent processing. On my own machine, a runtime for 100 observations takes ~2.7 ms. 

### MPI

This implementation uses MPI accross 4 processes to run k-means clustering.

### Hyrid

This uses both CUDA and MPI to run k-means clustering. Performance for this implementation is about the same or slower than the other parallel implementations.

### CUDA

This implementation uses CUDA to run k-means clustering. This has the best performance of all the implementations at any dataset size (among the sizes included in this repo).

## Data Generation

This directory contains the data files used, as well as the Python scripts to generate the data.

These programs do nothing fancy. Data is generated by scikit-learn's [make_blobs](https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html). The data is 5-dimensional, so visualizing it is a bit difficult. In any case, the first two features of the generated data are plotted. Plots are generated by [matplotlib](https://matplotlib.org/3.2.1/index.html).

## Misc. info

The code in this project aims to evaluate heterogenous computing in k-means.

Assuming that thwe directory hierarchy is maintained, all code should compile
and run without issue.

### Compiling

Compiling can be accompilished by changing to the directory for which code
should be run. Once in that directory, simply using the bash command `make`
will compile the program in question.

### Running

Script files are provided with all the implementations. Using sbatch with
a script file will run the code. Sbatch will return an output file
and the code will generate cluster assignments for the data as well as
timing statistics (in the form of a CSV file).

### Observation count

The number of observations to cluster is coded in the C files. To change the
amount of observations clusters, change the variable `OBSERVATIONS` to either
one of 100, 1000, 10000, 100000, and 1000000. The code will have to be recompiled.

## Important Note

This repository has never been maintained since this research has concluded. As such, there's a lot of bugs with the code that I no longer have the time to find or fix. If you run any of this code under `valgrind`, you're very likely to make Valgrind, myself, and yourself cry. Otherwise, you're more than welcome to use this code for your own work... but you've been warned.
